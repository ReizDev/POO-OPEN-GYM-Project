<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Dashboard Admin - Socios</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="shortcut icon" href="img/businessman.png" type="image/x-icon">
  <link rel="stylesheet" href="script.js">
</head>
<body>
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Listado de socios</h2>
    <button class="btn btn-outline-danger">Cerrar sesión</button>
  </div>

  <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#modalSocio" onclick="abrirModal()">➕ Agregar nuevo socio</button>
  
  <table class="table table-striped table-bordered" id="tablaSocios">
    <thead class="table-dark">
      <tr>
        <th>ID</th><th>Nombre</th><th>Email</th><th>Teléfono</th><th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <!-- Filas dinámicas -->
    </tbody>
  </table>
</div>

<!-- Modal -->
<div class="modal fade" id="modalSocio" tabindex="-1">
  <div class="modal-dialog">
    <form class="modal-content" onsubmit="guardarSocio(event)">
      <div class="modal-header"><h5 class="modal-title" id="modalTitulo">Nuevo Socio</h5></div>
      <div class="modal-body">
        <input type="hidden" id="socioId">
        <input type="text" id="nombre" class="form-control mb-2" placeholder="Nombre completo" required>
        <input type="email" id="email" class="form-control mb-2" placeholder="Correo electrónico" required>
        <input type="text" id="telefono" class="form-control mb-2" placeholder="Teléfono" required>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success">Guardar</button>
        <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
      </div>
    </form>
  </div>
</div>

<script>
let socios = [];
let contadorId = 1;

// Cargar datos desde localStorage al iniciar
window.onload = () => {
  const datosGuardados = localStorage.getItem("socios");
  if (datosGuardados) {
    socios = JSON.parse(datosGuardados);
    contadorId = socios.length ? Math.max(...socios.map(s => s.id)) + 1 : 1;
    renderTabla();
  }
};

function guardarEnLocalStorage() {
  localStorage.setItem("socios", JSON.stringify(socios));
}

function renderTabla() {
  const tbody = document.querySelector("#tablaSocios tbody");
  tbody.innerHTML = "";
  socios.forEach(socio => {
    const fila = `
      <tr>
        <td>${socio.id}</td>
        <td>${socio.nombre}</td>
        <td>${socio.email}</td>
        <td>${socio.telefono}</td>
        <td>
          <button class="btn btn-warning btn-sm" onclick="editarSocio(${socio.id})">Editar</button>
          <button class="btn btn-danger btn-sm" onclick="eliminarSocio(${socio.id})">Eliminar</button>
        </td>
      </tr>`;
    tbody.innerHTML += fila;
  });
}

function abrirModal() {
  document.getElementById("modalTitulo").textContent = "Nuevo Socio";
  document.getElementById("socioId").value = "";
  document.getElementById("nombre").value = "";
  document.getElementById("email").value = "";
  document.getElementById("telefono").value = "";
}

function guardarSocio(event) {
  event.preventDefault();
  const id = document.getElementById("socioId").value;
  const nombre = document.getElementById("nombre").value;
  const email = document.getElementById("email").value;
  const telefono = document.getElementById("telefono").value;

  if (id) {
    // Update
    const socio = socios.find(s => s.id == id);
    socio.nombre = nombre;
    socio.email = email;
    socio.telefono = telefono;
  } else {
    // Create
    socios.push({ id: contadorId++, nombre, email, telefono });
  }

  guardarEnLocalStorage();
  renderTabla();
  bootstrap.Modal.getInstance(document.getElementById("modalSocio")).hide();
}

function editarSocio(id) {
  const socio = socios.find(s => s.id == id);
  document.getElementById("modalTitulo").textContent = "Editar Socio";
  document.getElementById("socioId").value = socio.id;
  document.getElementById("nombre").value = socio.nombre;
  document.getElementById("email").value = socio.email;
  document.getElementById("telefono").value = socio.telefono;
  new bootstrap.Modal(document.getElementById("modalSocio")).show();
}

function eliminarSocio(id) {
  if (confirm("¿Seguro que deseas eliminar este socio?")) {
    socios = socios.filter(s => s.id != id);
    guardarEnLocalStorage();
    renderTabla();
  }
}

</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
